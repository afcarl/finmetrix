<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Implied Volatility via Bisection method</title>
  <meta name="author" content="Stanislav Khrapov">

  

  <link href="http://khrapovs.github.com/finmetrix/feeds/all.rss.xml" type="application/rss+xml" rel="alternate"
        title="Pythonic FinMetrix RSS Feed" />

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-17393493-7', 'khrapovs.github.io');
  ga('send', 'pageview');
  </script>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="../../../../../favicon.ico" rel="icon">
  <link href="../../../../../theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="../../../../../theme/js/modernizr-2.0.js"></script>
  <script src="../../../../../theme/js/ender.js"></script>
  <script src="../../../../../theme/js/octopress.js" type="text/javascript"></script>

  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">

  
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="../../../../../">Pythonic FinMetrix</a></h1>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://khrapovs.github.com/finmetrix/feeds/all.rss.xml" rel="subscribe-rss">RSS</a></li>
</ul>



<ul class="main-navigation">
    <li><a href="https://sites.google.com/site/khrapovs">About</a></li>
    <li><a href="mailto:khrapovs@gmail.com">Contact</a></li>
    <li><a href="/archives.html">Archives</a></li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">Implied Volatility via Bisection method</h1>
      <p class="meta"><time datetime="2014-04-18T14:00:00" pubdate>Apr 18, 2014</time></p>
</header>

  <div class="entry-content"><p>
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this post I will show how to find implied volatilities from Black-Scholes formula using bisection method.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>First of all, import all necessary libraries</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[1]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">erf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">suppress</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> <span class="n">inline</span>
</pre></div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[2]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Standard Normal distribution with math library only</span>
<span class="k">def</span> <span class="nf">Phi</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">erf</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check how it works</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[3]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">Phi</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_display_data">


<img src="data:image/png;base64,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
v//eqqiosFJTU61169Z5q6RarV+/3tqwYYOVlZVlrVixos52sbGx1u7du31Y2W8aUqM/9OXDDz9s
jR071rIsyxozZkytf+eWZU9fNqR/Zs+ebfXt29eyLMtavny5lZmZ6dMaG1pnSUmJ1a9fP5/XdrzP
PvvMWrlypdWlS5daX/eHvrSs+uv0h760LMvatm2btWrVKsuyLOvgwYNWx44dm/376bWRe3Z2Nqf8
55SMzMzMWte+N+QmKW9LSkqiY8eODWpr2TSD1ZAa/aEvj7+hbdCgQXz88cd1tvV1XwbKDXkN/Xu0
63fxVz179qRdu3Z1vu4PfQn11wn29yXABRdcQFpaGgBt2rQhOTmZH3/88YQ2je1Tn5xRNHnyZHJy
cmr8eUNukvIXYWFhXHPNNWRkZPDmm2/aXU4N/tCXO3bsqF4pFRkZWecvnh19GSg35DWkzrCwMJYu
XUpqaio5OTmsW7fOpzU2hD/0ZUP4Y19u2bKFVatWkZmZecKfN7ZPm7XbS3Z2Ntu3b6/x56NHj6Zf
v34APPvss5x22mncdtttNdr56manhtRZnyVLltC+fXt27txJdnY2SUlJ9OzZ029qtLsvn3322Rr1
1FWTt/uyNoFyQ15DPu/SSy+lvLycVq1aMWfOHG644QY2btzog+oax+6+bAh/68uff/6ZAQMGMG7c
ONq0aVPj9cb0abPCff78+W5fnzp1KkVFRSxcuLDW16OioigvL69+Xl5eTnR0dHNKqlV9dTZE+/bt
ATjvvPO48cYbKS0t9WggNbdGf+jLyMhItm/fzgUXXMC2bds4//zza23n7b6sTUP65+Q2W7duJSoq
yqt1nawhdZ5xxhnVj/v27cvdd9/Nnj17OPvss31WZ338oS8bwp/68tixY9x000386U9/4oYbbqjx
emP71GvTMsXFxfztb3+jsLCQFnUcanr8TVIVFRVMnz6d3Nxcb5VUr7rm3g4fPszBgwcBOHToEPPm
zXO7SsCb6qrRH/oyNzeXadOmATBt2rRaf0Ht6suG9E9ubi5vv/02gNsb8uyuc8eOHdW/B6WlpViW
5VfBDv7Rlw3hL31pWRZDhgyhU6dOPPDAA7W2aXSfeurb3pPFx8dbF154oZWWlmalpaVZw4cPtyzL
spxOp5WTk1PdrqioyOrYsaMVFxdnjR492lvl1GnmzJlWdHS01aJFCysyMtLq06dPjTo3b95spaam
WqmpqVbnzp19XmdDarQs+/ty9+7d1tVXX20lJCRY2dnZ1t69e2vUaWdf1tY/r7/+uvX6669Xt7nn
nnusuLhCFelMAAAAjElEQVQ4KyUlxe3qKTvrzM/Ptzp37mylpqZa3bt3t5YtW+bzGvPy8qz27dtb
ERERVnR0tDVp0iS/7Mv66vSHvrQsy/r888+tsLAwKzU1tTozi4qKmtWnuolJRCQI+WS1jIiI+JbC
XUQkCCncRUSCkMJdRCQIKdxFRIKQwl1EJAgp3EVEgpDCXUQkCP0/1mNJdExKJd4AAAAASUVORK5C
YII=
">

</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simple-BS-formula">Simple BS formula<a class="anchor-link" href="#Simple-BS-formula">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
Black-Scholes formula
<p>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[4]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Black-Scholes Function</span>
<span class="k">def</span> <span class="nf">BS</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">):</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">S</span><span class="o">/</span><span class="n">K</span><span class="p">)</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sig</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">sig</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">-</span> <span class="n">sig</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">cp</span> <span class="o">==</span> <span class="s">&#39;C&#39;</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">S</span><span class="o">*</span><span class="n">Phi</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span> <span class="o">-</span> <span class="n">K</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">Phi</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cp</span> <span class="o">==</span> <span class="s">&#39;P&#39;</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">K</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">Phi</span><span class="p">(</span><span class="o">-</span><span class="n">d2</span><span class="p">)</span> <span class="o">-</span> <span class="n">S</span><span class="o">*</span><span class="n">Phi</span><span class="p">(</span><span class="o">-</span><span class="n">d1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check how it works</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[5]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># S - stock price</span>
<span class="c"># K - strike</span>
<span class="c"># T - maturity in years</span>
<span class="c"># r - log risk free rate annualized</span>
<span class="c"># sig - volatililty annualized</span>
<span class="c"># cp - call/put flag</span>
<span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span> <span class="o">=</span> <span class="mf">105.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">30.</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">15</span><span class="p">,</span> <span class="s">&#39;C&#39;</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">BS</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Call price: </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">C</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
Call price: 5.2822

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define function to find implied volatility given option price</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[6]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Function to find BS Implied Vol using Bisection Method</span>
<span class="k">def</span> <span class="nf">impvol</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">fcount</span> <span class="o">=</span> <span class="mf">1e3</span><span class="p">):</span>
    <span class="n">sig</span><span class="p">,</span> <span class="n">sig_u</span><span class="p">,</span> <span class="n">sig_d</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1e-3</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">BS</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="o">-</span> <span class="n">C</span>

    <span class="c"># repeat until error is sufficiently small or counter hits fcount</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">fcount</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sig_d</span> <span class="o">=</span> <span class="n">sig</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig_u</span> <span class="o">+</span> <span class="n">sig</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sig_u</span> <span class="o">=</span> <span class="n">sig</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig_d</span> <span class="o">+</span> <span class="n">sig</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        
        <span class="n">err</span> <span class="o">=</span> <span class="n">BS</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="o">-</span> <span class="n">C</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="c"># return NA if counter hit fcount</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="n">fcount</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sig</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check how it works</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[7]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Test code:</span>
<span class="c"># S - stock price</span>
<span class="c"># K - strike</span>
<span class="c"># T - maturity in years</span>
<span class="c"># R - risk free rate annualized</span>
<span class="c"># C - option price</span>
<span class="c"># cp - call/put flag</span>
<span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span> <span class="o">=</span> <span class="mf">105.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">30.</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">5.282</span><span class="p">,</span> <span class="s">&#39;C&#39;</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">impvol</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Implied volatility: </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">v</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
Implied volatility: 0.1500

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Standardized-BS-formula">Standardized BS formula<a class="anchor-link" href="#Standardized-BS-formula">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
Denote<br><span class="math">\(F=Se^{rT}\)</span> as forward price, and<br><span class="math">\(X=\log\left(K/F\right)\)</span> as log-forward moneyness.<br> Also normalize the option price by the spot. This gives us the following standardized BS formula which depends only on three inputs versus five in the original version.
<p>


</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[8]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Standardized Black-Scholes Function</span>
<span class="k">def</span> <span class="nf">BSst</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">):</span>
    <span class="c"># X = log(K/S)</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span> <span class="o">/</span> <span class="p">(</span><span class="n">sig</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">sig</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">-</span> <span class="n">sig</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">if</span> <span class="n">cp</span> <span class="o">==</span> <span class="s">&#39;C&#39;</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">Phi</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">*</span><span class="n">Phi</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cp</span> <span class="o">==</span> <span class="s">&#39;P&#39;</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">*</span><span class="n">Phi</span><span class="p">(</span><span class="o">-</span><span class="n">d2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Phi</span><span class="p">(</span><span class="o">-</span><span class="n">d1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check how it works</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[9]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span> <span class="o">=</span> <span class="mf">105.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">30.</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">15</span><span class="p">,</span> <span class="s">&#39;C&#39;</span>
<span class="n">C1</span> <span class="o">=</span> <span class="n">BS</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Call price (simple): </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">C1</span>

<span class="c"># X - log-forward moneyness</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">S</span><span class="p">)</span>
<span class="n">C2</span> <span class="o">=</span> <span class="n">BSst</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="o">*</span> <span class="n">S</span>
<span class="k">print</span> <span class="s">&#39;Call price (standardized): </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">C2</span>

<span class="k">print</span> <span class="s">&#39;The result conincides: &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
Call price (simple): 5.2822
Call price (standardized): 5.2822
The result conincides:  True

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define function to find implied volatility given standardized option price</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[10]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Function to find BS Implied Vol using Bisection Method</span>
<span class="k">def</span> <span class="nf">impvol_st</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">fcount</span> <span class="o">=</span> <span class="mf">1e3</span><span class="p">):</span>
    <span class="n">sig</span><span class="p">,</span> <span class="n">sig_u</span><span class="p">,</span> <span class="n">sig_d</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1e-3</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">BSst</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="o">-</span> <span class="n">C</span>
    
    <span class="c"># repeat until error is sufficiently small or counter hits fcount</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">fcount</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sig_d</span> <span class="o">=</span> <span class="n">sig</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig_u</span> <span class="o">+</span> <span class="n">sig</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sig_u</span> <span class="o">=</span> <span class="n">sig</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig_d</span> <span class="o">+</span> <span class="n">sig</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        
        <span class="n">err</span> <span class="o">=</span> <span class="n">BSst</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="o">-</span> <span class="n">C</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="c"># return NA if counter hit 1000</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="n">fcount</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sig</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check how it works</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[11]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span> <span class="o">=</span> <span class="mf">105.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">30.</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">5.282</span><span class="p">,</span> <span class="s">&#39;C&#39;</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">impvol</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Implied volatility: </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">v1</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">S</span><span class="p">)</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">impvol_st</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="o">/</span><span class="n">S</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Implied volatility (standardized): </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">v2</span>

<span class="k">print</span> <span class="s">&#39;The result conincides: &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
Implied volatility: 0.1500
Implied volatility (standardized): 0.1499
The result conincides:  False

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[12]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span> <span class="o">=</span> <span class="mf">105.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">30.</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">5.282</span><span class="p">,</span> <span class="s">&#39;C&#39;</span>
<span class="o">%</span><span class="k">timeit</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">impvol</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Implied volatility: </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">v1</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">S</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">impvol_st</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="o">/</span><span class="n">S</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Implied volatility (standardized): </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">v2</span>

<span class="k">print</span> <span class="s">&#39;The result conincides: &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
10000 loops, best of 3: 71.2 µs per loop
Implied volatility: 0.1500
10000 loops, best of 3: 96.1 µs per loop
Implied volatility (standardized): 0.1499
The result conincides:  False

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Vectorize-the-function">Vectorize the function<a class="anchor-link" href="#Vectorize-the-function">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>The following is all we need to create a vectorized version of the function</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[13]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Use standard Numpy vectorization function</span>
<span class="c"># The vector size is determined by the first input</span>
<span class="n">vec_impvol_st</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">impvol_st</span><span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check how it works</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[14]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Number of option prices</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span>

<span class="n">v</span> <span class="o">=</span> <span class="n">vec_impvol_st</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="o">/</span><span class="n">S</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Implied volatility (standardized): &#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
Implied volatility (standardized):  [ 0.15  0.15  0.15  0.15  0.15  0.15  0.15  0.15  0.15  0.15]

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Is there any benefit over a loop operation?</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[15]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="k">print</span> <span class="s">&#39;Loop (simple):&#39;</span>
<span class="o">%</span><span class="k">timeit</span> <span class="p">[</span><span class="n">impvol</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="k">print</span> <span class="s">&#39;Loop (standardized):&#39;</span>
<span class="o">%</span><span class="k">timeit</span> <span class="p">[</span><span class="n">impvol_st</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="o">/</span><span class="n">S</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="k">print</span> <span class="s">&#39;Numpy vectorize:&#39;</span>
<span class="o">%</span><span class="k">timeit</span> <span class="n">vec_impvol_st</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="o">/</span><span class="n">S</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
Loop (simple):
100 loops, best of 3: 7.09 ms per loop
Loop (standardized):
100 loops, best of 3: 9.45 ms per loop
Numpy vectorize:
100 loops, best of 3: 3.6 ms per loop

</pre>
</div>
</div>

</div>
</div>

</div></p></div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">Stanislav Khrapov</span>
  </span>
<time datetime="2014-04-18T14:00:00" pubdate>Apr 18, 2014</time>  <span class="categories">
    <a class="category" href="../../../../../tag/black-scholes.html">Black-Scholes</a>
    <a class="category" href="../../../../../tag/implied-volatility.html">implied volatility</a>
  </span>
</p><div class="sharing">
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="../../../../../blog/2014/04/18/imp-vol-bisection/" data-via="khrapovs" data-counturl="../../../../../blog/2014/04/18/imp-vol-bisection/" >Tweet</a>
  <div class="g-plusone" data-size="medium"></div>
</div>    </footer>
  </article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
  </section>
</div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="../../../../../blog/2014/04/21/particle-filter-heston/">Particle Filter with Heston model</a>
      </li>
      <li class="post">
          <a href="../../../../../blog/2014/04/21/fitting-term-structure/">Fitting term structure of interest rates</a>
      </li>
      <li class="post">
          <a href="../../../../../blog/2014/04/21/diffusion-estimation/">Estimation of Simple Diffusion Models with OLS, MLE, SML, GMM</a>
      </li>
      <li class="post">
          <a href="../../../../../blog/2014/04/21/vasicek-bond-pricing/">Bond Pricing with Vasicek Model</a>
      </li>
      <li class="post">
          <a href="../../../../../blog/2014/04/21/vix-replication/">Replication of VIX</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="../../../../../category/econometrics.html">econometrics</a></li>
        <li><a href="../../../../../category/finmetrix.html">finmetrix</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
    <a href="../../../../../tag/diffusions.html">diffusions</a>,    <a href="../../../../../tag/bandwidth.html">bandwidth</a>,    <a href="../../../../../tag/ols.html">OLS</a>,    <a href="../../../../../tag/transforms.html">transforms</a>,    <a href="../../../../../tag/vix.html">VIX</a>,    <a href="../../../../../tag/term-structure.html">term structure</a>,    <a href="../../../../../tag/gmm.html">GMM</a>,    <a href="../../../../../tag/black-scholes.html">Black-Scholes</a>,    <a href="../../../../../tag/cox-ingersoll-ross.html">Cox-Ingersoll-Ross</a>,    <a href="../../../../../tag/sml.html">SML</a>,    <a href="../../../../../tag/nonparametrics.html">nonparametrics</a>,    <a href="../../../../../tag/vasicek.html">Vasicek</a>,    <a href="../../../../../tag/implied-volatility.html">implied volatility</a>,    <a href="../../../../../tag/bonds.html">bonds</a>,    <a href="../../../../../tag/kernel-regression.html">kernel regression</a>,    <a href="../../../../../tag/interest-rates.html">interest rates</a>,    <a href="../../../../../tag/heston.html">Heston</a>,    <a href="../../../../../tag/mle.html">MLE</a>,    <a href="../../../../../tag/realized-volatility.html">Realized Volatility</a>,    <a href="../../../../../tag/particle-filter.html">particle filter</a>,    <a href="../../../../../tag/optimization.html">optimization</a>,    <a href="../../../../../tag/geometric-browninan-motion.html">Geometric Browninan Motion</a>,    <a href="../../../../../tag/options.html">options</a>  </section>



  <section>
    <h1>GitHub Repos</h1>
    <ul id="gh_repos">
      <li class="loading">Status updating...</li>
    </ul>
    <script type="text/javascript">
      $.domReady(function(){
          if (!window.jXHR){
              var jxhr = document.createElement('script');
              jxhr.type = 'text/javascript';
              jxhr.src = '../../../../../theme/js/jXHR.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(jxhr, s);
          }

          github.showRepos({
              user: 'khrapovs',
              count: 5,
              skip_forks: false,
              target: '#gh_repos'
          });
      });
    </script>
    <script src="../../../../../theme/js/github.js" type="text/javascript"> </script>
  </section>

    <section>
        <h1>Social</h1>
        <ul>
            <li><a href="http://khrapovs.github.com/finmetrix/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">RSS</a></li>
            <li><a href="http://www.linkedin.com/in/khrapovs" target="_blank">LinkedIn</a></li>
            <li><a href="https://twitter.com/khrapovs" target="_blank">Twitter</a></li>
            <li><a href="https://www.google.com/+StanislavKhrapov" target="_blank">Google+</a></li>
        </ul>
    </section>

<section>
    <p>Follow <a href="http://twitter.com/khrapovs">@khrapovs</a></p>
</section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
      Copyright &copy; 2014 - Stanislav Khrapov -
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-17393493-7']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-17393493-7');
    ga('send', 'pageview');
</script>
	<script type="text/javascript">
	  var disqus_shortname = 'pythonicfinmetrix';
          var disqus_identifier = '/blog/2014/04/18/imp-vol-bisection/';
          var disqus_url = '../../../../../blog/2014/04/18/imp-vol-bisection/';
          var disqus_title = 'Implied Volatility via Bisection method';
	  (function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	   })();
	</script>
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>
</body>
</html>