<!DOCTYPE html>
<html lang="en">
<head>

        <title>Test title 2</title>
        <meta charset="utf-8" />
        <link href="http://khrapovs.github.io/finmetrix/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Pythonic FinMetrix RSS Feed" />
        <link href="http://khrapovs.github.io/finmetrix/feeds/cat1.rss.xml" type="application/rss+xml" rel="alternate" title="Pythonic FinMetrix Categories RSS Feed" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="http://khrapovs.github.io/finmetrix/theme/gumby.css" />
        <link rel="stylesheet" type="text/css" href="http://khrapovs.github.io/finmetrix/theme/style.css" />
        <link rel="stylesheet" type="text/css" href="http://khrapovs.github.io/finmetrix/theme/pygment.css" />

        <script src="http://khrapovs.github.io/finmetrix/theme/js/libs/modernizr-2.6.2.min.js"></script>






</head>

<body id="index" class="home">


    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h1><a href="http://khrapovs.github.io/finmetrix">Pythonic FinMetrix <strong></strong></a></h1>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>
             
              <ul class="columns">
                <li><a href="http://khrapovs.github.io/finmetrix">Home</a></li>

                <li><a href="https://sites.google.com/site/khrapovs">About</a></li>
                <li><a href="mailto:khrapovs@gmail.com">Contact</a></li>

              </ul>
            </div>

<section id="content" class="body">

   <div class="row">
        <div class="eleven columns">


            <header>
              <h2 class="entry-title">
                <a href="http://khrapovs.github.io/finmetrix/blog/2014/04/16/my-test-post2/" rel="bookmark"
                   title="Permalink to Test title 2">Test title 2</a></h2>
           
            </header>
            <footer class="post-info">
              <abbr class="published" title="2014-04-16T22:20:00">
                Apr 16, 2014
              </abbr>
              <address class="vcard author">
                By <a class="url fn" href="http://khrapovs.github.io/finmetrix/author/stas-khrapov.html">Stas Khrapov</a>
              </address>
            </footer><!-- /.post-info -->
            <div class="entry-content">
              <p>This will be turned into :abbr:<code>HTML (HyperText Markup Language)</code>.</p>
<p><iframe width='640' height='390' src='http://www.youtube.com/embed/_dm_2G' frameborder='0' webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe></p>
<figure class='code'>
<figcaption><span>"test title" test.py</span> <a href='/downloads/code/test.py'>download</a></figcaption>

<div class="highlight"><pre><span class="n">import</span> <span class="n">numpy</span> <span class="n">as</span> <span class="n">np</span>
</pre></div>


</figure>

<p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Implied-Volatility-via-Bisection-method">Implied Volatility via Bisection method<a class="anchor-link" href="#Implied-Volatility-via-Bisection-method">&#182;</a></h1>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Author:<br> Stanislav Khrapov<br> <a href="mailto:khrapovs@gmail.com">khrapovs@gmail.com</a><br> http://sites.google.com/site/khrapovs/<br></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import all necessary libraries</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[1]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">erf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">suppress</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[2]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Standard Normal distribution with math library only</span>
<span class="k">def</span> <span class="nf">Phi</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">erf</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check how it works</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[3]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">Phi</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
oqOjrQ4dOpT6vi+dS8u6eE7L8p1zaVmWlZKSYj333HOWZVnWsWPHrN///veuY5U9px6/Qn/uuecY
PHiw6y/P5b/ZsHPr1q3ExsYSFhZGREQEUVFRrg9da1psbCxTp04td3qt0+lk//79JCcnExcXR0pK
ig0JDXc5feF8XjgBLTExkVWrVpU6bve59JcJcu5yAuTk5DBu3Dg6duzI+PHj7YgIQFRUFIsXLy7z
79GXziVcPCf4zrkESEpKYuzYsYD5b6V27V83kqvsOa1Woc+ePZvo6OhSjwMHDhAeHs7hw4fp168f
b731VqnfKS4urvEJSeXlzMnJ4fHHH7/o75w6dYoRI0bwySefsHz5cv75z3+ya9cun8tZ0+ezvIyF
hYWuCWjlvb8d5/JC/jJBzl1OgN69ezN9+nTWrFnDxo0bbRuu7NGjR6nS+YUvnUu4eE7wnXMJUK9e
Pa644gqKi4tJSkrizTffdB2r7Dmt1p6igwYNYtCgQWW+v2vXLnr37s3EiRPp2LFjqWO/naxUExOS
LpbTnbp16zJixAjCf17Ht3PnzuzcuZPo6GhvRASqlrOmz2d5GXv27OnKUFxcTIMGDUodt+NcXshf
Jsi5ywnmc4hfCr9bt27s2LGDbt261XjOi/Glc3kpvnYuDx48SI8ePXj22Wfp1auX6/uVPaceH3LZ
s2cPSUlJzJ8/ny5dupQ53rZtWzZs2MDZs2cpLCwkLy+P5s2bezpGteXn5xMXF4fT6eTcuXNs3LiR
Vq1a2R2rDF84n7GxsXzxxRcALFu2jE6dOpU6bve5vDBfVlYWLVq0cB1r0qQJ+/fv5/jx4zgcDtav
X0+HDh1qLFtFcxYWFhIdHc3JkyexLIs1a9bQunVrW3JejC+dS3d87VweOXKE+++/n3feeYeBAweW
OlbZc1qtK/Ty/P3vf8fhcDBixAgAGjRoQGpqKpMnTyYqKoqHHnqIESNG0LFjR5xOJ+PGjeOyyy7z
dIwKCwkJIeSCBdkvzNm/f386dOhAWFgYAwcOpGnTpj6Z0+7zOXToUAYMGEDHjh2pU6cO8+bNK5PR
znP56KOPsnLlSmJjYwEzQW7+/PmuCXKTJk2iS5curglyDW3anPZSOcePH09CQgJ16tTh3nvvdY23
2+WXf4++eC4vVF5OXzqX48aNo7CwkLFjx7rG0pOTkzl58mSlz6kmFomIBAhNLBIRCRAqdBGRAKFC
FxEJECp0EZEAoUIXEQkQKnQRkQChQhcRCRAqdBGRAPH/jmDU/seiv8EAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simple-BS-formula">Simple BS formula<a class="anchor-link" href="#Simple-BS-formula">&#182;</a></h2>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
Black-Scholes formula
<p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[4]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Black-Scholes Function</span>
<span class="k">def</span> <span class="nf">BS</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">):</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">S</span><span class="o">/</span><span class="n">K</span><span class="p">)</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sig</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">sig</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">-</span> <span class="n">sig</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">cp</span> <span class="o">==</span> <span class="s">&#39;C&#39;</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">S</span><span class="o">*</span><span class="n">Phi</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span> <span class="o">-</span> <span class="n">K</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">Phi</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cp</span> <span class="o">==</span> <span class="s">&#39;P&#39;</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">K</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">Phi</span><span class="p">(</span><span class="o">-</span><span class="n">d2</span><span class="p">)</span> <span class="o">-</span> <span class="n">S</span><span class="o">*</span><span class="n">Phi</span><span class="p">(</span><span class="o">-</span><span class="n">d1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check how it works</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[5]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># S - stock price</span>
<span class="c"># K - strike</span>
<span class="c"># T - maturity in years</span>
<span class="c"># r - log risk free rate annualized</span>
<span class="c"># sig - volatililty annualized</span>
<span class="c"># cp - call/put flag</span>
<span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span> <span class="o">=</span> <span class="mf">105.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">30.</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">15</span><span class="p">,</span> <span class="s">&#39;C&#39;</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">BS</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Call price: </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">C</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
Call price: 5.2822

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define function to find implied volatility given option price</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[6]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Function to find BS Implied Vol using Bisection Method</span>
<span class="k">def</span> <span class="nf">impvol</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">fcount</span> <span class="o">=</span> <span class="mf">1e3</span><span class="p">):</span>
    <span class="n">sig</span><span class="p">,</span> <span class="n">sig_u</span><span class="p">,</span> <span class="n">sig_d</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1e-3</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">BS</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="o">-</span> <span class="n">C</span>

    <span class="c"># repeat until error is sufficiently small or counter hits fcount</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">fcount</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sig_d</span> <span class="o">=</span> <span class="n">sig</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig_u</span> <span class="o">+</span> <span class="n">sig</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sig_u</span> <span class="o">=</span> <span class="n">sig</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig_d</span> <span class="o">+</span> <span class="n">sig</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        
        <span class="n">err</span> <span class="o">=</span> <span class="n">BS</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="o">-</span> <span class="n">C</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="c"># return NA if counter hit fcount</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="n">fcount</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sig</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check how it works</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[7]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Test code:</span>
<span class="c"># S - stock price</span>
<span class="c"># K - strike</span>
<span class="c"># T - maturity in years</span>
<span class="c"># R - risk free rate annualized</span>
<span class="c"># C - option price</span>
<span class="c"># cp - call/put flag</span>
<span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span> <span class="o">=</span> <span class="mf">105.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">30.</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">5.282</span><span class="p">,</span> <span class="s">&#39;C&#39;</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">impvol</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Implied volatility: </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">v</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
Implied volatility: 0.1500

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Standardized-BS-formula">Standardized BS formula<a class="anchor-link" href="#Standardized-BS-formula">&#182;</a></h2>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
Denote<br><span class="math">\(F=Se^{rT}\)</span> as forward price, and<br><span class="math">\(X=\log\left(K/F\right)\)</span> as log-forward moneyness.<br> Also normalize the option price by the spot. This gives us the following standardized BS formula which depends only on three inputs versus five in the original version.
<p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[8]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Standardized Black-Scholes Function</span>
<span class="k">def</span> <span class="nf">BSst</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">):</span>
    <span class="c"># X = log(K/S)</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span> <span class="o">/</span> <span class="p">(</span><span class="n">sig</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">sig</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">-</span> <span class="n">sig</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">if</span> <span class="n">cp</span> <span class="o">==</span> <span class="s">&#39;C&#39;</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">Phi</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">*</span><span class="n">Phi</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cp</span> <span class="o">==</span> <span class="s">&#39;P&#39;</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">*</span><span class="n">Phi</span><span class="p">(</span><span class="o">-</span><span class="n">d2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Phi</span><span class="p">(</span><span class="o">-</span><span class="n">d1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check how it works</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[9]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span> <span class="o">=</span> <span class="mf">105.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">30.</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">15</span><span class="p">,</span> <span class="s">&#39;C&#39;</span>
<span class="n">C1</span> <span class="o">=</span> <span class="n">BS</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Call price (simple): </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">C1</span>

<span class="c"># X - log-forward moneyness</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">S</span><span class="p">)</span>
<span class="n">C2</span> <span class="o">=</span> <span class="n">BSst</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="o">*</span> <span class="n">S</span>
<span class="k">print</span> <span class="s">&#39;Call price (standardized): </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">C2</span>

<span class="k">print</span> <span class="s">&#39;The result conincides: &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
Call price (simple): 5.2822
Call price (standardized): 5.2822
The result conincides:  True

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define function to find implied volatility given standardized option price</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[10]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Function to find BS Implied Vol using Bisection Method</span>
<span class="k">def</span> <span class="nf">impvol_st</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">fcount</span> <span class="o">=</span> <span class="mf">1e3</span><span class="p">):</span>
    <span class="n">sig</span><span class="p">,</span> <span class="n">sig_u</span><span class="p">,</span> <span class="n">sig_d</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1e-3</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">BSst</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="o">-</span> <span class="n">C</span>
    
    <span class="c"># repeat until error is sufficiently small or counter hits fcount</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">fcount</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sig_d</span> <span class="o">=</span> <span class="n">sig</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig_u</span> <span class="o">+</span> <span class="n">sig</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sig_u</span> <span class="o">=</span> <span class="n">sig</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig_d</span> <span class="o">+</span> <span class="n">sig</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        
        <span class="n">err</span> <span class="o">=</span> <span class="n">BSst</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="o">-</span> <span class="n">C</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="c"># return NA if counter hit 1000</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="n">fcount</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sig</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check how it works</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[11]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span> <span class="o">=</span> <span class="mf">105.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">30.</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">5.282</span><span class="p">,</span> <span class="s">&#39;C&#39;</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">impvol</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Implied volatility: </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">v1</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">S</span><span class="p">)</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">impvol_st</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="o">/</span><span class="n">S</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Implied volatility (standardized): </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">v2</span>

<span class="k">print</span> <span class="s">&#39;The result conincides: &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
Implied volatility: 0.1500
Implied volatility (standardized): 0.1499
The result conincides:  False

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[12]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span> <span class="o">=</span> <span class="mf">105.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">30.</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">5.282</span><span class="p">,</span> <span class="s">&#39;C&#39;</span>
<span class="o">%</span><span class="k">timeit</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">impvol</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Implied volatility: </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">v1</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">S</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">impvol_st</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="o">/</span><span class="n">S</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Implied volatility (standardized): </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">v2</span>

<span class="k">print</span> <span class="s">&#39;The result conincides: &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
10000 loops, best of 3: 71.2 µs per loop
Implied volatility: 0.1500
10000 loops, best of 3: 96.1 µs per loop
Implied volatility (standardized): 0.1499
The result conincides:  False

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Vectorize-the-function">Vectorize the function<a class="anchor-link" href="#Vectorize-the-function">&#182;</a></h2>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following is all we need to create a vectorized version of the function</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[13]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Use standard Numpy vectorization function</span>
<span class="c"># The vector size is determined by the first input</span>
<span class="n">vec_impvol_st</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">impvol_st</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check how it works</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[14]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Number of option prices</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span>

<span class="n">v</span> <span class="o">=</span> <span class="n">vec_impvol_st</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="o">/</span><span class="n">S</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Implied volatility (standardized): &#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
Implied volatility (standardized):  [ 0.15  0.15  0.15  0.15  0.15  0.15  0.15  0.15  0.15  0.15]

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Is there any benefit over a loop operation?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[15]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="k">print</span> <span class="s">&#39;Loop (simple):&#39;</span>
<span class="o">%</span><span class="k">timeit</span> <span class="p">[</span><span class="n">impvol</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="k">print</span> <span class="s">&#39;Loop (standardized):&#39;</span>
<span class="o">%</span><span class="k">timeit</span> <span class="p">[</span><span class="n">impvol_st</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="o">/</span><span class="n">S</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="k">print</span> <span class="s">&#39;Numpy vectorize:&#39;</span>
<span class="o">%</span><span class="k">timeit</span> <span class="n">vec_impvol_st</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="o">/</span><span class="n">S</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
Loop (simple):
100 loops, best of 3: 7.09 ms per loop
Loop (standardized):
100 loops, best of 3: 9.45 ms per loop
Numpy vectorize:
100 loops, best of 3: 3.6 ms per loop

</pre>
</div>
</div>

</div>
</div>

</div></p>
            </div><!-- /.entry-content -->


        </div><!-- /.eleven.columns -->
        
<div class="three columns">

<h4>Pages</h4>

 <ul>
      <li><a href="https://sites.google.com/site/khrapovs">About</a></li>
      <li><a href="mailto:khrapovs@gmail.com">Contact</a></li>
  </ul>

<h4>Categories</h4>
<ul>
		<li><a href="http://khrapovs.github.io/finmetrix/category/cat1.html">cat1</a></li>
</ul>


<h4>Tags</h4>
	<ul>
	    <li class="tag-4"><a href="http://khrapovs.github.io/finmetrix/tag/tag1.html">tag1</a></li>
	    <li class="tag-4"><a href="http://khrapovs.github.io/finmetrix/tag/tag2.html">tag2</a></li>
</ul>


<nav class="widget">
  <h4>Social</h4>
  <ul>
    <li><a href="http://www.linkedin.com/in/khrapovs">LinkedIn</a></li>
    <li><a href="https://twitter.com/khrapovs">Twitter</a></li>
    <li><a href="https://www.google.com/+StanislavKhrapov">Google+</a></li>
  </ul>
</nav>

</div> </div><!-- /.row -->


</section>

       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">

    
        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">

                <li><div class="btn primary"><a href="http://github.com/khrapovs/" target="_blank">Github</a></div></li>




              </ul>
            </div>
          </div>
        </footer>

    </div>


  <script src="http://khrapovs.github.io/finmetrix/theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="http://khrapovs.github.io/finmetrix/theme/js/libs/gumby.min.js"></script>
  <script src="http://khrapovs.github.io/finmetrix/theme/js/plugins.js"></script>
</body>
</html>